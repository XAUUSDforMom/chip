<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>スプレッドシート JSON 表示</title>
<style>
  body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    background: #f9f9f9;
    padding: 20px;
  }
  table {
    border-collapse: collapse;
    width: 100%;
    max-width: 800px;
    margin: auto;
    background: #fff;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 0 8px rgba(0,0,0,0.1);
  }
  th, td {
    padding: 12px 16px;
    border-bottom: 1px solid #ddd;
    text-align: left;
  }
  th {
    background: #f0f0f0;
  }
  tr:last-child td {
    border-bottom: none;
  }
</style>
</head>
<body>

<h1>スプレッドシート JSON 表示サンプル</h1>
<table id="data-table">
  <thead></thead>
  <tbody></tbody>
</table>

<script>
  // ここにあなたのGoogle Apps Scriptの公開URLを入れてください
  const jsonUrl = "https://script.google.com/macros/s/AKfycbzCtIqxtASCZUvydeEEhd3bGfTjVUFDxDyFt1RDjew6qCvzljc0y5nfsMy8_jrNnYCh/exec";

  fetch(jsonUrl)
    .then(response => response.json())
    .then(data => {
      if (!data.length) {
        document.getElementById("data-table").innerHTML = "<tr><td>データがありません</td></tr>";
        return;
      }

      const tableHead = document.querySelector("#data-table thead");
      const tableBody = document.querySelector("#data-table tbody");

      // ヘッダー作成（JSONの最初のオブジェクトのキーを使用）
      const headers = Object.keys(data[0]);
      const headerRow = document.createElement("tr");
      headers.forEach(header => {
        const th = document.createElement("th");
        th.textContent = header;
        headerRow.appendChild(th);
      });
      tableHead.appendChild(headerRow);

      // データ行作成
      data.forEach(item => {
        const tr = document.createElement("tr");
        headers.forEach(key => {
          const td = document.createElement("td");
          td.textContent = item[key];
          tr.appendChild(td);
        });
        tableBody.appendChild(tr);
      });
    })
    .catch(err => {
      console.error(err);
      document.getElementById("data-table").innerHTML = "<tr><td>データの取得に失敗しました</td></tr>";
    });
</script>

</body>
</html>
