<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>スプレッドシート JSON 複数シート表示</title>
<style>
  body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    background: #f9f9f9;
    padding: 20px;
  }
  select {
    font-size: 16px;
    margin-bottom: 16px;
    padding: 6px 10px;
  }
  table {
    border-collapse: collapse;
    width: 100%;
    max-width: 900px;
    margin: auto;
    background: #fff;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 0 8px rgba(0,0,0,0.1);
  }
  th, td {
    padding: 12px 16px;
    border-bottom: 1px solid #ddd;
    text-align: left;
  }
  th {
    background: #f0f0f0;
  }
  tr:last-child td {
    border-bottom: none;
  }
</style>
</head>
<body>

<h1>複数シート JSON 表示サンプル</h1>

<label for="sheetSelect">表示するシートを選択：</label>
<select id="sheetSelect"></select>

<table id="data-table">
  <thead></thead>
  <tbody></tbody>
</table>

<script>
  const jsonUrl = "https://script.google.com/macros/s/AKfycbzotwknkpjySFF5NTR2-WkZuiksQl9W86a7Cz_WLOv9P8JYHQgOWQfgY_D150sMHUH-/exec"; // ここにApps Script URLを入れる

  let allData = {};
  let currentSheet = null;

  const sheetSelect = document.getElementById("sheetSelect");
  const tableHead = document.querySelector("#data-table thead");
  const tableBody = document.querySelector("#data-table tbody");

  // テーブル描画関数
  function renderTable(sheetName) {
    tableHead.innerHTML = "";
    tableBody.innerHTML = "";

    if (!allData[sheetName] || allData[sheetName].length === 0) {
      tableBody.innerHTML = "<tr><td>データがありません</td></tr>";
      return;
    }

    const headers = Object.keys(allData[sheetName][0]);
    const headerRow = document.createElement("tr");
    headers.forEach(header => {
      const th = document.createElement("th");
      th.textContent = header;
      headerRow.appendChild(th);
    });
    tableHead.appendChild(headerRow);

    allData[sheetName].forEach(item => {
      const tr = document.createElement("tr");
      headers.forEach(key => {
        const td = document.createElement("td");
        td.textContent = item[key];
        tr.appendChild(td);
      });
      tableBody.appendChild(tr);
    });
  }

  // セレクトボックスにシート名をセット
  function populateSheetSelect() {
    sheetSelect.innerHTML = "";
    Object.keys(allData).forEach(sheetName => {
      const option = document.createElement("option");
      option.value = sheetName;
      option.textContent = sheetName;
      sheetSelect.appendChild(option);
    });
    currentSheet = Object.keys(allData)[0];
    renderTable(currentSheet);
  }

  sheetSelect.addEventListener("change", e => {
    currentSheet = e.target.value;
    renderTable(currentSheet);
  });

  fetch(jsonUrl)
    .then(response => response.json())
    .then(json => {
      allData = json;
      populateSheetSelect();
    })
    .catch(err => {
      console.error(err);
      tableBody.innerHTML = "<tr><td>データの取得に失敗しました</td></tr>";
    });
</script>

</body>
</html>
